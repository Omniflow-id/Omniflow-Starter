<nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
  <div class="sb-sidenav-menu">
    <div class="nav">
      <a
        class="nav-link {% if url == '/admin' or url == '/admin/' %}active{% endif %}"
        href="/admin"
      >
        {{ t('sidebar.dashboard') }}
      </a>
      <a
        class="nav-link {% if url.includes('/admin/profile') %}active{% endif %}"
        href="/admin/profile"
      >
        {{ t('sidebar.profile') }}
      </a>
      <a
        class="nav-link {% if url.includes('/admin/overview') or url.includes('/admin/submodule') %}{% else %}collapsed{% endif %}"
        href="#"
        data-bs-toggle="collapse"
        data-bs-target="#collapseLayouts"
        aria-expanded="{% if url.includes('/admin/overview') or url.includes('/admin/submodule') %}true{% else %}false{% endif %}"
        aria-controls="collapseLayouts"
      >
        {{ t('sidebar.module') }}
        <div class="sb-sidenav-collapse-arrow">
          <i class="fas fa-angle-down"></i>
        </div>
      </a>
      <div
        class="collapse {% if url.includes('/admin/overview') or url.includes('/admin/submodule') %}show{% endif %}"
        id="collapseLayouts"
        aria-labelledby="headingOne"
        data-bs-parent="#sidenavAccordion"
      >
        <nav class="sb-sidenav-menu-nested nav">
          <a
            class="nav-link {% if url.includes('/admin/overview') %}active{% endif %}"
            href="/admin/overview"
            >{{ t('sidebar.overview') }}</a
          >
          <a
            class="nav-link {% if url.includes('/admin/submodule') %}active{% endif %}"
            href="/admin/submodule"
            >{{ t('sidebar.submodule') }}</a
          >
        </nav>
      </div>
      {% if hasAnyPermission(permissions, ['view_users', 'manage_users']) %}
      <!-- User Management - Based on permissions -->
      <a
        class="nav-link {% if url.includes('/admin/user') %}{% else %}collapsed{% endif %}"
        href="#"
        data-bs-toggle="collapse"
        data-bs-target="#collapseLayoutsUser"
        aria-expanded="{% if url.includes('/admin/user') %}true{% else %}false{% endif %}"
        aria-controls="collapseLayoutsUser"
      >
        {{ t('sidebar.users') }}
        <div class="sb-sidenav-collapse-arrow">
          <i class="fas fa-angle-down"></i>
        </div>
      </a>
      <div
        class="collapse {% if url.includes('/admin/user') %}show{% endif %}"
        id="collapseLayoutsUser"
        aria-labelledby="headingOne"
        data-bs-parent="#sidenavAccordion"
      >
        <nav class="sb-sidenav-menu-nested nav">
          <a
            class="nav-link {% if url.includes('/admin/user/overview') %}active{% endif %}"
            href="/admin/user/overview"
            >{{ t('sidebar.overview') }}</a
          >
          <a
            class="nav-link {% if url.includes('/admin/user/index') %}active{% endif %}"
            href="/admin/user/index"
            >{{ t('sidebar.users') }}</a
          >
        </nav>
      </div>
      {% endif %}

      {% if hasPermission(permissions, 'manage_permissions') %}
      <!-- Permissions Management - Based on permissions -->
      <a
        class="nav-link {% if url.includes('/admin/permissions') or url.includes('/admin/roles') %}{% else %}collapsed{% endif %}"
        href="#"
        data-bs-toggle="collapse"
        data-bs-target="#collapseLayoutsPermissions"
        aria-expanded="{% if url.includes('/admin/permissions') or url.includes('/admin/roles') %}true{% else %}false{% endif %}"
        aria-controls="collapseLayoutsPermissions"
      >
        {{ t('sidebar.permissions') }}
        <div class="sb-sidenav-collapse-arrow">
          <i class="fas fa-angle-down"></i>
        </div>
      </a>
      <div
        class="collapse {% if url.includes('/admin/permissions') or url.includes('/admin/roles') %}show{% endif %}"
        id="collapseLayoutsPermissions"
        aria-labelledby="headingOne"
        data-bs-parent="#sidenavAccordion"
      >
        <nav class="sb-sidenav-menu-nested nav">
          <a
            class="nav-link {% if url.includes('/admin/permissions') and not url.includes('/admin/roles') %}active{% endif %}"
            href="/admin/permissions"
            >{{ t('sidebar.allPermissions') }}</a
          >
          <a
            class="nav-link {% if url.includes('/admin/roles') %}active{% endif %}"
            href="/admin/roles"
            >{{ t('sidebar.roles') }}</a
          >
        </nav>
      </div>
      {% endif %}

      {% if hasPermission(permissions, 'manage_cache') %}
      <!-- Cache Management - Based on permissions -->
      <a
        class="nav-link {% if url.includes('/admin/cache') %}active{% endif %}"
        href="/admin/cache/stats"
      >
        {{ t('sidebar.cache') }}
      </a>
      {% endif %}

      {% if hasPermission(permissions, 'manage_queue') %}
      <!-- Queue Management - Based on permissions -->
      <a
        class="nav-link {% if url.includes('/admin/queue') %}{% else %}collapsed{% endif %}"
        href="#"
        data-bs-toggle="collapse"
        data-bs-target="#collapseLayoutsQueue"
        aria-expanded="{% if url.includes('/admin/queue') %}true{% else %}false{% endif %}"
        aria-controls="collapseLayoutsQueue"
      >
        {{ t('sidebar.queue') }}
        <div class="sb-sidenav-collapse-arrow">
          <i class="fas fa-angle-down"></i>
        </div>
      </a>
      <div
        class="collapse {% if url.includes('/admin/queue') %}show{% endif %}"
        id="collapseLayoutsQueue"
        aria-labelledby="headingOne"
        data-bs-parent="#sidenavAccordion"
      >
        <nav class="sb-sidenav-menu-nested nav">
          <a
            class="nav-link {% if url == '/admin/queue' %}active{% endif %}"
            href="/admin/queue"
            >{{ t('sidebar.statistics') }}</a
          >
          <a
            class="nav-link {% if url.includes('/admin/queue/jobs') %}active{% endif %}"
            href="/admin/queue/jobs"
            >{{ t('sidebar.allJobs') }}</a
          >
          <a
            class="nav-link {% if url.includes('/admin/queue/failed') %}active{% endif %}"
            href="/admin/queue/failed"
            >{{ t('sidebar.failedJobs') }}</a
          >
        </nav>
      </div>
      {% endif %}

      {% if hasPermission(permissions, 'view_logs') %}
      <!-- Activity Logs - Based on permissions -->
      <a
        class="nav-link {% if url.includes('/admin/log') %}active{% endif %}"
        href="/admin/log/index"
      >
        {{ t('sidebar.logs') }}
      </a>
      {% endif %}
    </div>
  </div>
  <div class="sb-sidenav-footer">
    <div class="small">{{ t('sidebar.loggedInAs') }}:</div>
    <span class="fw-bold">{{ user.username }}</span>
  </div>
</nav>
